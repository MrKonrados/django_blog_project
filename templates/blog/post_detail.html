{% extends "blog/base.html" %}
{% load pluralize_pl %}
{% load static %}

{% block content %}

    <!-- Start Blog post -->
    <div class="single-blog-post">
        <div class="post-img">
            <img src="{{ post.image.url }}" class="img-responsive" alt="Blog image">
        </div>
        <h1 class="post-title">{{ post.title }}</h1>

        <div class="post-meta">
            <ul class=" pull-left">
                <li><i class="fa fa-clock-o"></i>{{ post.modified }}</li>
                <li><i class="fa fa-user"></i><a
                        href="{% url 'posts_by_author' post.author.username %}">{{ post.author }}</a></li>
                <li><i class="fa fa-file"></i><a href="#">Blog</a></li>
                <li><i class="fa fa-tags"></i>
                    {% for tag in post.tags.all %}
                        <a href="{% url 'posts_by_tag' tag %}">{{ tag }}</a>
                    {% endfor %}</li>
                <li>
                    <i class="fa fa-comments"></i>{{ post.comments.count }} {{ post.comments.count|pluralize_pl:"komentarz,komentarzy,komentarze" }}
                </li>
            </ul>
            <ul class="pull-right">
                <li>font-size<i class="fa fa-minus-circle"></i><i class="fa fa-plus-circle"></i></li>
                <li><a href="#">Print</a></li>
                <li><a href="#">Email</a></li>
            </ul>
        </div>

        <p class="post-content">{{ post.content }}</p>

        <div class="item-content-footer">
            <ul>
                <li>Read 286 times</li>
                <li class="rating">
                    Rate this item
                    <span class="active"><i class="fa fa-star-o"></i></span>
                    <span class="active"><i class="fa fa-star-o"></i></span>
                    <span class="active"><i class="fa fa-star-o"></i></span>
                    <span><i class="fa fa-star-o"></i></span>
                    <span><i class="fa fa-star-o"></i></span>
                </li>
            </ul>
        </div>

    </div>
    <!-- End Blog Post -->

    <!-- Start Blog Author Section -->
    <div class="blog-author">
        <h3>O autorze</h3>
        <div class="media">
            <div class="media-left">
                <a href="{% url 'posts_by_author' post.author.username %}">
                    <img class="media-object" src="{{ post.author.avatar.url }}" alt="...">
                </a>
            </div>
            <div class="media-body">
                <h4 class="media-heading"><a
                        href="{% url 'posts_by_author' post.author.username %}">{{ post.author }}</a></h4>
                <p>{{ post.author.about }}</p>
            </div>
        </div>
    </div>
    <!-- End Blog Author Section -->

    <!-- Start Comments Section -->
    <div id="comments">

        <h2 class="comments-title">{{ post.comments.count }} {{ post.comments.count|pluralize_pl:"komentarz,komentarzy,komentarze" }}</h2>

        {% if post.comments.all %}
            <ol class="comments-list">
                {% load mptt_tags %}
                {% with post.comments.all as comments %}
                    {% recursetree comments %}
                        <li>
                            <div class="comment-box clearfix">
                                <div class="avatar"><img alt="" src="{% static 'blog/images/user-2.png' %}"></div>
                                <div class="comment-content">
                                    <div class="comment-meta">
                                        <span class="comment-by">{{ node.name }}</span>
                                        <span class="reply-link pull-right">
                                            <a href="javascript:;" data-parent_id="{{ node.id }}"
                                               data-toggle="modal" data-target="#comment-reply">Odpowiedz</a>
                                        </span>
                                    </div>
                                    <span class="comment-date">{{ node.created }}</span>
                                    <p>{{ node.content }}</p>
                                </div>
                            </div>
                            <ul>
                                {{ children }}
                            </ul>
                        </li>
                    {% endrecursetree %}
                {% endwith %}
            </ol>
        {% endif %}
        <div id="respond">
            <h2 class="respond-title">Napisz komentarz</h2>
            <span class="form-caution">Pola oznaczone (*) są obowiązkowe do wypełnienia.</span>
            <form action="" method="POST">{% csrf_token %}
                {% include 'blog/comment_form.html' %}
                <div class="row">
                    <div class="col-md-12">
                        <input name="submit" type="submit" id="submit" class="btn btn-primary" value="Opublikuj">
                    </div>
                </div>
            </form>
        </div>

    </div>
    <div class="modal fade" id="comment-reply" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Zamknij"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Odpowiedz na komentarz</h4>
                </div>
                <form action="" method="POST">{% csrf_token %}
                    <div class="modal-body">
                        {% include 'blog/comment_form.html' %}
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                            <button name="submit" type="submit" id="reply" class="btn btn-primary">Odpowiedz</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Comments Section -->
{% endblock %}

